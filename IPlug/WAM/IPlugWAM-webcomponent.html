<script src="audioworklet.js"></script>
<script src="wam-controller.js"></script>
<script src="IPlugWAM-awn.js"></script>
<dom-module id="IPlugWAM">
  <template>
    <style>
      body {
        font-family: sans-serif;
        font-weight: 100;
        font-size: 14px;
        user-select: none;
        cursor: default;
        padding: 5px 0 0 10px;
      }

      header {
        margin-bottom: 20px;
      }

      h1 {
        font-weight: 100;
        margin: 0;
        font-size: 20px;
      }

      #unsupported {
        margin-bottom: 30px;
      }

      #unsupported a {
        text-decoration: underline;
      }

      #content {
        width: 800px;
        background: #000;
        padding: 5px;
      }

      #topbar {
        display: flex;
        background: #222;
        color: #eee;
        height: 40px;
        line-height: 40px;
        padding-left: 10px;
        border-bottom: 5px solid darkgreen;
      }

      .right {
        display: flex;
        margin-left: auto;
      }

      .control {
        margin: 0 10px;
      }

      label {
        color: #bbb;
        font-size: 12px;
      }

      select {
        background: #222;
        color: #eee;
        height: 20px;
        margin-top: 10px;
        cursor: pointer;
      }

      li {
        cursor: pointer;
      }

      footer {
        width: 810px;
        display: flex;
        justify-content: flex-end;
        font-size: 12px;
        color: #444;
        margin-top: 5px;
      }

      a,
      a:visited {
        color: #000;
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
        color: darkgreen;
      }
    </style>
    <div id="content">
    </div>
  </template>
  <script>
    IPlugWAM = Polymer({

      is: 'IPlugWAM',

      created: function main() {

        if (AWPF.isAudioWorkletPolyfilled)
          actx = AWPF.context;
        else actx = GlobalContext.context;

        IPLUGWAM.importScripts(actx).then(() => {
          IPlugWAM = new IPLUGWAM(actx);
          myoutput = actx.createGain();
          IPlugWAM.connect(myoutput);
          initGUI();
          initMidi();
        });

        function initGUI() {
          let dx = document.querySelector("IPlugWAM");
        }

        function initMidi() {
        }
      }

    })
  </script>
</dom-module>